# Implementation Plan

- [x] 1. 建立專案結構和基礎 HTML 框架





  - 創建 index.html 檔案，包含 Bootstrap 5 CDN 和基本 HTML 結構
  - 設定響應式 meta 標籤和基本 SEO 標籤
  - 建立 CSS 和 JavaScript 檔案的基本架構
  - _Requirements: 7.1, 7.2_

- [x] 2. 實作圖片上傳功能





  - [x] 2.1 建立拖放上傳區域 UI


    - 使用 Bootstrap 卡片組件建立上傳區域
    - 加入拖放視覺提示和 Bootstrap Icons
    - 實作響應式設計，適配不同螢幕尺寸
    - _Requirements: 1.1, 3.1, 3.2_

  - [x] 2.2 實作檔案選擇和驗證邏輯

    - 建立檔案輸入處理函數
    - 實作圖片格式驗證 (JPG, PNG, GIF)
    - 加入檔案大小限制和錯誤處理
    - _Requirements: 1.1, 1.4_

  - [x] 2.3 實作拖放功能

    - 加入 dragover, dragenter, dragleave, drop 事件處理
    - 實作拖放視覺回饋效果
    - 整合檔案驗證邏輯
    - _Requirements: 1.1, 1.2_

- [x] 3. 建立圖片預覽和 Canvas 處理系統




  - [x] 3.1 實作圖片載入和顯示


    - 建立 Canvas 元素用於圖片處理
    - 實作圖片載入和尺寸計算邏輯
    - 加入載入狀態指示器 (Bootstrap Spinner)
    - _Requirements: 1.2, 1.3_

  - [x] 3.2 建立響應式圖片預覽容器


    - 實作自適應圖片顯示邏輯
    - 確保圖片在不同螢幕尺寸下正確顯示
    - 加入圖片縮放和居中功能
    - _Requirements: 3.1, 3.3, 3.4_

- [x] 4. 實作浮水印類型選擇介面





  - [x] 4.1 建立浮水印類型選擇器


    - 使用 Bootstrap Button Group 建立選項切換
    - 實作預設類型和自訂文字的切換邏輯
    - 加入視覺狀態指示
    - _Requirements: 2.1, 5.1_

  - [x] 4.2 實作預設浮水印類型


    - 建立預設浮水印資料結構 (台灣身分證等)
    - 實作預設類型選擇和應用邏輯
    - 加入預設類型的預覽功能
    - _Requirements: 2.1, 2.2_

- [x] 5. 建立自訂文字浮水印功能





  - [x] 5.1 實作文字輸入介面


    - 使用 Bootstrap Input Group 建立文字輸入框
    - 加入即時輸入驗證和提示訊息
    - 實作輸入狀態的視覺回饋
    - _Requirements: 5.1, 5.4_


  - [x] 5.2 實作即時文字預覽

    - 建立文字輸入事件監聽器
    - 實作即時浮水印預覽更新
    - 加入文字為空時的處理邏輯
    - _Requirements: 5.2, 5.3_

- [x] 6. 實作浮水印樣式控制功能





  - [x] 6.1 建立透明度控制器


    - 使用 Bootstrap Range Slider 建立透明度調整
    - 實作即時透明度預覽更新
    - 加入數值顯示和標籤
    - _Requirements: 6.2_

  - [x] 6.2 實作文字大小控制


    - 建立文字大小調整滑桿
    - 實作即時字體大小預覽
    - 設定合理的大小範圍限制
    - _Requirements: 6.4_

  - [x] 6.3 建立位置控制介面


    - 使用 Bootstrap Button Grid 建立位置選擇器
    - 實作預設位置選項 (左上、右上、左下、右下、中央)
    - 加入位置選擇的視覺回饋
    - _Requirements: 6.1_

- [x] 7. 實作浮水印拖拽定位功能





  - [x] 7.1 建立拖拽事件處理


    - 實作 mousedown, mousemove, mouseup 事件處理
    - 加入觸控裝置的 touch 事件支援
    - 實作拖拽邊界限制邏輯
    - _Requirements: 6.3, 3.2_

  - [x] 7.2 實作拖拽視覺回饋


    - 加入拖拽時的游標變化
    - 實作拖拽過程中的視覺提示
    - 確保拖拽操作的流暢性
    - _Requirements: 6.3_

- [x] 8. 建立浮水印渲染引擎







  - [x] 8.1 實作 Canvas 浮水印繪製




    - 建立浮水印繪製函數
    - 實作文字和預設類型的渲染邏輯
    - 加入透明度和位置計算
    - _Requirements: 2.3, 5.2, 6.2_

  - [x] 8.2 實作即時預覽更新系統





    - 建立預覽更新觸發機制
    - 實作高效的 Canvas 重繪邏輯
    - 加入防抖動處理避免過度渲染
    - _Requirements: 2.2, 5.2, 6.2_

- [x] 9. 實作圖片下載功能




  - [x] 9.1 建立圖片匯出邏輯


    - 實作 Canvas 轉圖片功能
    - 保持原始圖片品質和格式
    - 加入下載檔名生成邏輯
    - _Requirements: 8.2, 8.3_

  - [x] 9.2 實作下載按鈕和介面


    - 使用 Bootstrap 按鈕建立下載介面
    - 加入下載狀態指示和成功回饋
    - 實作瀏覽器相容性處理
    - _Requirements: 2.4, 8.1, 8.4_

- [x] 10. 實作響應式設計和行動裝置支援





  - [x] 10.1 優化手機版介面


    - 調整按鈕大小符合觸控標準 (min-height: 44px)
    - 實作單欄佈局和適當間距
    - 加入底部固定操作按鈕
    - _Requirements: 3.1, 3.2_

  - [x] 10.2 實作螢幕方向適應


    - 加入 orientation change 事件處理
    - 實作佈局自動調整邏輯
    - 確保所有功能在不同方向下正常運作
    - _Requirements: 3.4_

- [x] 11. 實作嵌入模式支援





  - [x] 11.1 建立嵌入環境檢測


    - 實作 iframe 環境檢測邏輯
    - 建立嵌入模式的介面調整
    - 移除不必要的 header/footer 元素
    - _Requirements: 4.4, 4.2_

  - [x] 11.2 優化嵌入模式體驗


    - 調整最小高度和佈局
    - 實作 postMessage 通訊機制
    - 確保嵌入模式不影響父頁面
    - _Requirements: 4.1, 4.3_

- [ ] 12. 實作錯誤處理和使用者回饋
  - [ ] 12.1 建立錯誤處理系統
    - 實作各種錯誤情況的捕獲和處理
    - 使用 Bootstrap Alert 組件顯示錯誤訊息
    - 加入錯誤恢復和重試機制
    - _Requirements: 1.4, 7.4_

  - [ ] 12.2 實作載入狀態和進度指示
    - 加入 Bootstrap Spinner 載入指示器
    - 實作操作進度的視覺回饋
    - 確保使用者了解系統狀態
    - _Requirements: 7.3_

- [ ] 13. 實作使用者偏好設定記憶功能
  - [ ] 13.1 建立 LocalStorage 設定管理
    - 實作設定的儲存和讀取邏輯
    - 建立預設設定和設定驗證
    - 加入設定重置功能
    - _Requirements: 6.5_

  - [ ] 13.2 實作設定自動載入
    - 在頁面載入時恢復使用者設定
    - 實作設定變更的自動儲存
    - 確保設定在不同會話間保持一致
    - _Requirements: 6.5_

- [ ]* 14. 建立測試和品質保證
  - [ ]* 14.1 撰寫單元測試
    - 測試圖片處理函數的正確性
    - 測試浮水印生成邏輯
    - 測試設定驗證和錯誤處理
    - _Requirements: All_

  - [ ]* 14.2 進行跨瀏覽器測試
    - 測試主流瀏覽器的相容性
    - 驗證行動裝置的功能完整性
    - 測試嵌入模式的穩定性
    - _Requirements: 3.1, 4.1_

- [ ] 15. 最終整合和優化
  - [ ] 15.1 整合所有功能模組
    - 確保所有功能正確協作
    - 優化程式碼結構和效能
    - 加入最終的錯誤處理和邊界情況
    - _Requirements: All_

  - [ ] 15.2 進行使用者體驗優化
    - 調整動畫和過渡效果
    - 優化載入時間和響應速度
    - 確保無障礙設計標準符合性
    - _Requirements: 7.1, 7.2, 7.3_